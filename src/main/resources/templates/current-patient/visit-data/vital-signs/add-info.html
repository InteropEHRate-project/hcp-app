<!DOCTYPE html>
<html lang="en" layout:decorate="~{layouts/layoutcurrentpatient}"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs}">vital signs</title>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>

    <style>
        .select2-container .select2-selection--single{
            height:34px !important;
        }
        .select2-container--default .select2-selection--single{
            border: 1px solid #ccc !important;
            border-radius: 0px !important;
        }
    </style>

    <script th:inline="javascript">
        /*<![CDATA[*/
        const map = [[${correlations}]];
        /*]]>*/

        $(document).ready(function () {
            var unit = "";
            document.getElementById("analysisName").addEventListener("change", setUnit);

            function setUnit() {
                document.getElementById("unitOfMeasurement").setAttribute("value", map[document.getElementById("analysisName").value]);
            }
        })
    </script>
</head>
<body>
<div layout:fragment="content">
    <div class="m-3"></div>
    <h2>Add Vital Signs information</h2>
    <div class="m-5"></div>
    <form action="#" th:action="@{/current-patient/visit-data/vital-signs/save-add}" th:object="${vitalSignsInfoCommand}" method="post">
        <div th:if="${#fields.hasErrors('*')}" class="alert alert-danger">
            <p>Please correct the errors below</p>
        </div>
        <div class="form-row">
            <div class="col-md-6">
                <label for="analysisName" th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs.type}">Vital Sign Type</label>
                <select class="form-control select2" id="analysisName" th:field="*{analysisName}">
                    <option selected value="" th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs.choose}">Choose a type</option>
                    <option input type="text" class="form-control" th:each="type : ${vitalSignsTypes}" th:classappend="${#fields.hasErrors('analysisName')} ? 'is-invalid' :''" th:value="${type.getName()}" th:text="${type.getName()}">Analysis name</option>
                </select>
                <div class="invalid-feedback" th:if="${#fields.hasErrors('analysisName')}">
                    <ul>
                        <li th:each="err : ${#fields.errors('analysisName')}" th:text="${err}">err</li>
                    </ul>
                </div>
                <br>
            </div>

            <div class="col-md-6">
                <label for="localDateOfVitalSign" th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs.local.date}">Date:</label><br>
                <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1" th:field="*{vitalSignsInfoCommandSample.localDateOfVitalSign}" id="localDateOfVitalSign" placeholder="Date"/>
                    <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar-alt"></i></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div class="col-md-6">
                <label for="currentValue" th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs.value}">Value of the Vital Signs</label><br>
                <input id="currentValue" type="number" step="0.01" class="form-control" th:classappend="${#fields.hasErrors('vitalSignsInfoCommandSample.currentValue')} ? 'is-invalid' :''" th:field="*{vitalSignsInfoCommandSample.currentValue}">
                <div class="invalid-feedback" th:if="${#fields.hasErrors('vitalSignsInfoCommandSample.currentValue')}">
                    <ul>
                        <li th:each="err : ${#fields.errors('vitalSignsInfoCommandSample.currentValue')}" th:text="${err}">err</li>
                    </ul>
                </div>
            </div>

            <div class="col-md-6">
                <label for="unitOfMeasurement" th:text="#{fragment.current.patient.navigation.left.visit.data.vital.signs.unit}">Unit of Measurement</label><br>
                <input style="pointer-events: none; opacity: 0.8; background-color: lightgray" id="unitOfMeasurement" type="text" class="form-control" th:classappend="${#fields.hasErrors('vitalSignsInfoCommandSample.unitOfMeasurement')} ? 'is-invalid' :''" th:field="*{vitalSignsInfoCommandSample.unitOfMeasurement}">
                <div class="invalid-feedback" th:if="${#fields.hasErrors('vitalSignsInfoCommandSample.unitOfMeasurement')}">
                    <ul>
                        <li th:each="err : ${#fields.errors('vitalSignsInfoCommandSample.unitOfMeasurement')}" th:text="${err}">err</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="text-right"><br>
            <button type="submit" class="btn btn-primary" th:text="#{button.save}">Save</button>
        </div>
    </form>
</div>

<script>
    $.fn.datetimepicker.Constructor.Default = $.extend({}, $.fn.datetimepicker.Constructor.Default, {
        icons: {
            time: 'far fa-clock',
            date: 'far fa-calendar',
            up: 'fas fa-arrow-up',
            down: 'fas fa-arrow-down',
            previous: 'fas fa-chevron-left',
            next: 'fas fa-chevron-right',
            today: 'far fa-calendar-check-o',
            clear: 'far fa-trash',
            close: 'far fa-times'
        }
    });

    $('#datetimepicker1').datetimepicker({
        format: 'DD/MM/YYYY h:mm A'
    });
</script>
<script>
    $('.select2').select2();
</script>

</body>
</html>